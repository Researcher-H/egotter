<script>
  (function(global){
    var Exception = function (msg1, msg2) {
      this.msg1 = msg1;
      this.msg2 = msg2;
      this.isLogin = <%= user_signed_in? ? 'true' : 'false' %>;
    };

    Exception.prototype.showMessage = function () {
      $('.error-msg').html(this.isLogin ? this.msg1 : this.msg2);
      $('.rescue-box').show();
    };

    var tooManyRequests = new Exception(
      '<%= I18n.t("after_sign_in.too_many_requests") %>',
      '<%= I18n.t("before_sign_in.too_many_requests", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    var unauthorized = new Exception(
      '<%= I18n.t("after_sign_in.unauthorized", sign_out_link: link_to(I18n.t('dictionary.sign_out'), sign_out_path)).html_safe %>',
      '<%= I18n.t("before_sign_in.unauthorized", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    var somethingError = new Exception(
      '<%= I18n.t("after_sign_in.something_is_wrong") %>',
      '<%= I18n.t("before_sign_in.something_is_wrong", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    var timeout = new Exception(
      '<%= I18n.t("after_sign_in.retry_timeout") %>',
      '<%= I18n.t("before_sign_in.retry_timeout", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    global.egotter = global.egotter || {};

    global.egotter.errors = {
      tooManyRequests: tooManyRequests, // <%= BackgroundSearchLog::TooManyRequests::MESSAGE %>
      unauthorized: unauthorized,       // <%= BackgroundSearchLog::Unauthorized::MESSAGE %>
      somethingError: somethingError,   // <%= BackgroundSearchLog::SomethingError::MESSAGE %>
      "Timeout": timeout
    };
  })(window);
</script>
