<script>
  (function(global){
    class Exception {
      constructor(msg1, msg2) {
        this.msg1 = msg1;
        this.msg2 = msg2;
        this.isLogin = <%= user_signed_in? ? 'true' : 'false' %>;
      }

      showMessage() {
        $('.error-msg').html(this.isLogin ? this.msg1 : this.msg2);
        $('.rescue-box').show();
      }
    }

    var tooManyRequests = new Exception(
      '<%= I18n.t("after_sign_in.too_many_requests") %>',
      '<%= I18n.t("before_sign_in.too_many_requests", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    var unauthorized = new Exception(
      '<%= I18n.t("after_sign_in.unauthorized", sign_out_link: link_to(I18n.t('dictionary.sign_out'), sign_out_path)).html_safe %>',
      '<%= I18n.t("before_sign_in.unauthorized", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    var somethingIsWrong = new Exception(
      '<%= I18n.t("after_sign_in.something_is_wrong") %>',
      '<%= I18n.t("before_sign_in.something_is_wrong", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    var timeout = new Exception(
      '<%= I18n.t("after_sign_in.retry_timeout") %>',
      '<%= I18n.t("before_sign_in.retry_timeout", sign_in_link: link_to(I18n.t('dictionary.sign_in'), welcome_path)).html_safe %>'
    );

    global.egotter = global.egotter || {};

    global.egotter.errors = {
      <%= BackgroundSearchLog::TooManyRequests::MESSAGE %>: tooManyRequests,
      <%= BackgroundSearchLog::Unauthorized::MESSAGE %>: unauthorized,
      <%= BackgroundSearchLog::SomethingError::MESSAGE %>: somethingIsWrong,
      "Timeout": timeout
    };
  })(window);
</script>
