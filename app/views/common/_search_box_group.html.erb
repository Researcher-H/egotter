<% input_tag_id = "screen-name-#{Random.rand(1000)}" %>

<%= form_tag searches_path, method: :post do %>
<label for="screen_name" class="sr-only"><%= t('searches.new.twitter_id') %></label>
<div class="input-group">
  <div class="input-group-addon">@</div>
  <input type="hidden" name="via" value="<%= via %>">
  <input type="search" id="<%= input_tag_id %>"
         name="screen_name"
         class="form-control"
         placeholder="<%= t('searches.new.search_by_twitter_id') %>"
         pattern="^[0-9A-Za-z_]{1,20}$"
         inputmode="verbatim"
         title="<%= t('before_sign_in.invalid_input', count1: 1, count2: 20) %>"
         required autofocus>
  <span class="input-group-btn">
    <button class="btn btn-primary" type="submit"><%= t('searches.new.search') %></button>
  </span>
</div>
<% end %>

<% if user_signed_in? && current_user.twitter_user %>
  <script>
    $(function () {
      var friends = <%= raw current_user.twitter_user.friends.pluck(:screen_name).to_json %>;
      $("#<%= input_tag_id %>").autocomplete({
        source: friends,
        minLength: 2
      });
    });
  </script>
<% end %>