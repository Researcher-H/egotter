<% user = current_user %>

<div class="menu">
  <h2><small><%= t('notifications.setting') %></small></h2>
  <%= form_for user.notification, url: menu_path do |f| %>
    <div class="checkbox">
      <label>
        <%= f.check_box :email %>
        <div><%= t('notifications.desc.email') %></div>
      </label>
    </div>
    <hr>

    <div class="checkbox">
      <label>
        <%= f.check_box :dm %>
        <div><%= t('notifications.desc.dm') %></div>
      </label>
    </div>
    <hr>

    <div class="checkbox">
      <label>
        <%= f.check_box :news %>
        <div><%= t('notifications.desc.news') %></div>
      </label>
    </div>
    <hr>

    <div class="checkbox">
      <label>
        <%= f.check_box :search %>
        <div><%= t('notifications.desc.search') %></div>
      </label>
    </div>

    <div style="margin: 15px 15px auto 15px;">
      <%= f.submit t('dictionary.save_settings'), class: 'btn btn-default btn-block' %>
    </div>
  <% end %>


  <div class="menu-search-histories">
    <hr style="display: none;">
    <h2 style="display: none;"><small><%= t('search_histories.index.title') %></small></h2>

    <%= render(partial: 'searches/adsense') %>
  </div>
  <script>
    $(function () {
      $.get('<%= search_histories_path %>', {in_modal: false})
          .done(function (res) {
            var container = $('.menu-search-histories');
            container.find('hr').show();
            container.find('h2').show();
            container.append(res.html);
          })
          .fail(function (xhr) {
            console.log(xhr.responseText);
          });
    });
  </script>

  <% if user.admin? %>
    <h2><small><%= t('debug.index') %></small></h2>
    <div>
      <%= link_to t('debug.index'), debug_path, class: 'btn btn-lg btn-info btn-block', style: 'margin-bottom: 15px;' %>
    </div>

    <h2><small><%= t('kpis.index') %></small></h2>
    <div>
      <%= link_to t('kpis.index'), kpis_path, class: 'btn btn-lg btn-info btn-block', style: 'margin-bottom: 15px;' %>
    </div>

    <h2><small><%= BackgroundSearchLog.model_name.human %></small></h2>
    <div>
      <%= link_to BackgroundSearchLog.model_name.human, background_search_logs_path, class: 'btn btn-lg btn-info btn-block', style: 'margin-bottom: 15px;' %>
    </div>

    <h2><small><%= t('caches.clear') %></small></h2>
    <div>
      <%= link_to t('caches.clear'), clear_result_cache_path, class: 'btn btn-lg btn-info btn-block', style: 'margin-bottom: 15px;', method: :post %>
    </div>
  <% end %>
</div>
