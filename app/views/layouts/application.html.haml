!!!
%html{lang: 'ja'}
  %head
    %meta{content: 'text/html; charset=UTF-8', 'http-equiv' => 'Content-Type'}/
    %meta{charset: 'utf-8'}/
    %meta{content: 'IE=edge', 'http-equiv' => 'X-UA-Compatible'}/
    %meta{content: 'width=device-width, initial-scale=1', name: 'viewport'}/
    = favicon_link_tag('/favicon.ico')
    %link{href: '/apple-touch-icon.png', rel: 'apple-touch-icon'}/
    %link{href: '/apple-touch-icon-120x120.png', rel: 'apple-touch-icon', sizes: '120x120'}/
    %link{href: '/apple-touch-icon-152x152.png', rel: 'apple-touch-icon', sizes: '152x152'}/
    = display_meta_tags(description: t('searches.common.description'), site: t('searches.common.title'), reverse: true, og: {title: :title, type: (action_name == 'new' ? 'website' : 'article'), url: request.original_url, image: 'http://egotter.com/egotter_kuma_840_450.png', site_name: :site, description: :description, locale: 'ja_JP'})
    %meta{content: 'summary_large_image', name: 'twitter:card'}/
    %meta{content: '@ego_tter', name: 'twitter:site'}/
    %link{href: '//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css', rel: 'stylesheet'}/
    %link{href: '//code.jquery.com/ui/1.12.0/themes/cupertino/jquery-ui.min.css', rel: 'stylesheet'}/
    = stylesheet_link_tag 'application', media: 'all'
    = javascript_include_tag 'application'
    %script{src: '//code.jquery.com/ui/1.12.0/jquery-ui.js'}
    %script{src: '//cdnjs.cloudflare.com/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js'}
    %script{src: '//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js'}
    %link{href: '//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css', rel: 'stylesheet', type: 'text/css'}/
    = csrf_meta_tags

    :javascript
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-13072051-3', 'auto'#{user_signed_in? ? ", { 'userId': '#{current_user.id}' }" : ''});
      ga('send', 'pageview');

    %script{async: '', src: '//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js'}
    :javascript
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-3146843071247817",
        enable_page_level_ads: true
      });

  %body
    :css
      @media (min-width: 768px) {
        .navbar > .container .navbar-brand {
          margin-left: 0;
        }
      }

    %nav.navbar.navbar-default
      .container
        .row
          .hidden-xs.col-sm-1.col-md-2.col-lg-2
          .col-xs-12.col-sm-10.col-md-8.col-lg-8
            .navbar-header.navbar-small
              - unless under_maintenance? || action_name == 'welcome'
                %button.navbar-toggle{'data-target' => '.search-modal', 'data-toggle' => 'modal', type: 'button'}
                  %span.glyphicon.glyphicon-search
                - if user_signed_in?
                  %button.btn-with-margin.navbar-toggle{type: 'button'}
                    = link_to menu_path do
                      %span.glyphicon.glyphicon-menu-hamburger
                  %button.btn-with-margin.navbar-toggle{type: 'button'}
                    = link_to notifications_path do
                      %span.glyphicon.glyphicon-bell
                - else
                  %button.btn.btn-with-margin.navbar-toggle{type: 'button'}
                    = link_to t('dictionary.sign_in'), welcome_path
              %a.navbar-brand{href: '/'}
                %img{alt: "#{t('dictionary.app_name')}", height: '48', src: '/logo_96_96.png', width: '48'}/
                %span= t('dictionary.app_name')
            - unless under_maintenance? || action_name == 'welcome'
              .collapse.navbar-collapse.navbar-large
                %ul.nav.navbar-nav.navbar-right
                  - if user_signed_in?
                    %li
                      %button.btn.btn-default.navbar-btn.btn-with-margin{type: 'button'}
                        = link_to notifications_path do
                          %span.glyphicon.glyphicon-bell
                          = t('notifications.title')
                    %li
                      %button.btn.btn-default.navbar-btn.btn-with-margin{type: 'button'}
                        = link_to menu_path do
                          %span.glyphicon.glyphicon-menu-hamburger
                          = t('misc.menu.title')
                  - else
                    %li
                      %button.btn.btn-default.navbar-btn.btn-with-margin{type: 'button'}
                        = link_to t('dictionary.sign_in'), welcome_path
                  %li
                    %button.btn.btn-default.navbar-btn{'data-target' => '.search-modal', 'data-toggle' => 'modal'}
                      %span.glyphicon.glyphicon-search
                      = t('searches.new.search')
          .hidden-xs.col-sm-1.col-md-2.col-lg-2

    - unless under_maintenance?
      .modal.fade.search-modal{'aria-labelledby' => 'search-modal-label', role: 'dialog', tabindex: '-1'}
        .modal-dialog{role: 'document'}
          .modal-content
            .modal-header
              %button.close{'aria-label' => 'Close', 'data-dismiss' => 'modal', type: 'button'}
                %span{'aria-hidden' => 'true'} ×
              %h4#search-modal-label.modal-title= t('searches.new.search_by_egotter')
            .modal-body
              = render partial: 'common/search_box_group', locals: {via: :search_history_input}
              .modal-search-histories
                %h2{style: 'display: none;'}
                  %small= t('search_histories.index.title')
              :javascript
                $(function () {
                  $('.search-modal').on('shown.bs.modal', function() {
                    $.post('#{modal_open_logs_path}', {name: 'search_history'});
                  });
                  $.get('#{search_histories_path}', {in_modal: true})
                      .done(function (res) {
                        var container = $('.modal-search-histories');
                        container.find('h2').show();
                        container.append(res.html);
                      })
                      .fail(function (xhr) {
                        console.log(xhr.responseText);
                      });
                });

    - if notice
      %p.alert.alert-info= raw notice
    - if alert
      %p.alert.alert-warning= raw alert

    .container
      .row
        .hidden-xs.col-sm-1.col-md-2.col-lg-2
        .col-xs-12.col-sm-10.col-md-8.col-lg-8
          = yield
        .hidden-xs.col-sm-1.col-md-2.col-lg-2

    %link{href: '//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css', rel: 'stylesheet', type: 'text/css'}/
    %link{href: '//cdn.jsdelivr.net/jquery.slick/1.6.0/slick-theme.css', rel: 'stylesheet', type: 'text/css'}/
    %script{src: '//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.min.js', type: 'text/javascript'}
    %script{src: '//code.highcharts.com/4.2.2/highcharts.js', type: 'text/javascript'}
    %script{src: '//code.highcharts.com/4.2.2/modules/drilldown.js', type: 'text/javascript'}
    %script{src: '//cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js', type: 'text/javascript'}
    %script{src: '/d3/d3.layout.cloud.js', type: 'text/javascript'}
    %script{src: '/d3/word_cloud.js', type: 'text/javascript'}
    %link{href: '/jssocials/jssocials.css', rel: 'stylesheet', type: 'text/css'}/
    %link{href: '/jssocials/jssocials-theme-flat.css', rel: 'stylesheet', type: 'text/css'}/
    %script{src: '/jssocials/jssocials.min.js'}

    - if %w(search_results searches statuses update_histories).include?(controller_name)
      .container
        .row
          .hidden-xs.col-sm-1.col-md-2.col-lg-2
          .col-xs-12.col-sm-10.col-md-8.col-lg-8
            .pre-footer
              %h2.h4.share-me= t('dictionary.share_me')
              = render(partial: 'searches/tweet_box', locals: {tweet_text: "#{egotter_share_text} http://egotter.com"})
              #share
              :javascript
                $(function () {
                  $("#share").jsSocials({
                    shares: ["twitter", "facebook", "googleplus"],
                    url: "http://egotter.com",
                    text: "#{raw egotter_share_text}",
                    showLabel: true,
                    showCount: true
                  });
                });
              .official-account
                %h2.h4= t('dictionary.official_account')
                .follow-official-account
                  %a.twitter-follow-button{'data-show-count' => 'false', 'data-size' => 'large', href: 'https://twitter.com/ego_tter'}
                    Follow @ego_tter
                  :javascript
                    $(function () {
                      !function (d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';
                        if (!d.getElementById(id)) {
                          js = d.createElement(s);
                          js.id = id;
                          js.src = p + '://platform.twitter.com/widgets.js';
                          fjs.parentNode.insertBefore(js, fjs);
                        }
                      }(document, 'script', 'twitter-wjs');
                    });
              .information
                %h2.h4{style: 'display: none;'}= t('dictionary.information')
              :javascript
                $(function () {
                  $.get('#{information_index_path}')
                      .done(function (res) {
                        var container = $('.information');
                        container.find('h2').show();
                        container.append(res.html);
                      })
                      .fail(function (xhr) {
                        console.log(xhr.responseText);
                      });
                });
          .hidden-xs.col-sm-1.col-md-2.col-lg-2

    - unless under_maintenance?
      %footer.footer
        .container
          %p.text-muted
            %a{href: '/'}> トップページ
              
            - if user_signed_in?
              = link_to t('dictionary.sign_out'), sign_out_path, data: {confirm: t('dictionary.realy_sign_out')}
            - else
              = link_to t('dictionary.sign_in'), welcome_path
                
            = succeed "\u{a0}\u{a0}" do
              %a{href: '/'} ご意見
            - if user_signed_in?
              = link_to t('misc.menu.title'), menu_path
                
            = succeed "\u{a0}\u{a0}" do
              %a{href: 'https://twitter.com/ego_tter', target: '_blank'}= t('dictionary.official_account')
            = link_to t('dictionary.support'), support_path
              
            = succeed "\u{a0}\u{a0}" do
              %a{href: 'https://github.com/ts-3156/egotter', target: '_blank'} Github
            = link_to t('misc.terms_of_service.title'), terms_of_service_path
              
            = link_to t('misc.privacy_policy.title'), privacy_policy_path
